define ("mod_lanebs/modal_book",["exports","jquery","core/ajax","core/modal_factory","core/modal_events","core/notification","core/modal","core/custom_interaction_events","core/modal_registry"],function(a,b,c,d,e,f,g,h,i){var j={CLOSE_BUTTON:"[data-action='close_button']",CONTENT_BLOCK:"[data-action='book_content_block']",CLOSE_CROSS:".close",ROOT_MODAL:"[data-region='modal-container']"},k=function(a){g.call(this,a);if(!this.getFooter().find(j.CLOSE_BUTTON).length){f.exception({message:"close button not found"})}};k.TYPE="mod_lanebs-book";k.CONTENT_BLOCK=j.CONTENT_BLOCK;k.prototype=Object.create(g.prototype);k.prototype.constructor=k;k.prototype.registerEventListeners=function(){g.prototype.registerEventListeners.call(this);this.getModal().on(h.events.activate,j.CLOSE_BUTTON,function(a){a.preventDefault();a.stopPropagation();this.getRoot().trigger("click")}.bind(this));this.getModal().on(h.events.scrollBottom,j.CONTENT_BLOCK,function(a){var d=[b(a.currentTarget).attr("data-id")];c.call([{methodname:"mod_lanebs_book_content",args:{id:d}}])[0].then(function(a){return a}).done(function(a){console.log(a['body']);if(JSON.parse(a.body).error&&404===JSON.parse(a.body).error.code){alert("\u0420\u0435\u0441\u0443\u0440\u0441 \u043E\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0432 \u0412\u0430\u0448\u0435\u043C \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u043D\u0438\u0438. \u041E\u0431\u0440\u0430\u0442\u0438\u0442\u0435\u0441\u044C \u043A \u0430\u0434\u043C\u0438\u043D\u0438\u0441\u0442\u0440\u0430\u0442\u043E\u0440\u0443.");k.prototype.getBookResult("\u0420\u0435\u0441\u0443\u0440\u0441 \u043E\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0432 \u0412\u0430\u0448\u0435\u043C \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u043D\u0438\u0438. \u041E\u0431\u0440\u0430\u0442\u0438\u0442\u0435\u0441\u044C \u043A \u0430\u0434\u043C\u0438\u043D\u0438\u0441\u0442\u0440\u0430\u0442\u043E\u0440\u0443.")}else{k.prototype.getBookResult(a.body)}}).fail(function(a){alert(a)})});this.getModal().on(h.events.activate,j.CLOSE_CROSS,function(a){a.preventDefault();a.stopPropagation();this.getRoot().trigger("click")}.bind(this));this.getRoot().on(h.events.activate,function(a){var c=b(j.ROOT_MODAL);if(1<c.length){c=c[1]}else{c=c[0]}if(a.target===c){this.getRoot().remove()}return!0}.bind(this))};k.prototype.getBookResult=function(a){console.log(a);var b=document.getElementById("book_iframe");b.contentWindow.document.open();b.contentWindow.document.write(a);b.contentWindow.document.close()};i.register(k.TYPE,k,"mod_lanebs/modal_book");return k});
//# sourceMappingURL=modal_book.min.js.map
