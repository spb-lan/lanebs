{"version":3,"sources":["../src/modal_search.js"],"names":["define","exports","$","ajax","ModalFactory","ModalEvents","Notification","Modal","CustomEvents","ModalRegistry","ModalBook","ModalBookHandler","fn","serializeAssoc","data","each","serializeArray","key","obj","a","name","match","subName","subKey","length","isArray","push","value","SELECTORS","SEARCH_TEXTBOX","START_SEARCH","START_SEARCH_CLEAR","CANCEL_BUTTON","CONTENT_BLOCK","BREADCRUMBS","CONTENT_NAME","TRIGGER_BOOK","ADD_BOOK","CATEGORY_BUTTON","CATEGORY_BLOCK","BOOK_PAGINATION","START_PAGE_CLASS","END_PAGE_CLASS","PROGRESS","LIMIT_ON_PAGE","ModalSearch","root","call","getBody","find","exception","message","TYPE","prototype","Object","create","constructor","breadcrumbs","registerEventListeners","submitFunction","e","preventDefault","stopPropagation","id","attr","args","searchParam","target","form","page","limit","catId","toggleClass","getAjaxCall","getSearchResult","then","resetPagination","getModal","on","events","activate","bind","val","trigger","disabledEnterSubmit","keyCode","setPagination","currentTarget","hasClass","maxPage","parseInt","prevPage","closest","nextPage","currentPage","removeClass","addClass","text","disabledKeyUp","getCategoryTree","categoryId","printCategories","response","empty","Math","ceil","body","total","items","number","item","descriptionBlock","description","authorBlock","author","append","title","year","init","contentName","siblings","available","hasChild","parent_id","click","clearCurrentCrumb","parentId","printBreadcrumbs","prepend","searchParentId","clearCrumbs","crumbs","html","slice","methodname","callback","done","JSON","parse","fail","alert","tmp","lastCrumb","keys","count","last","i","register"],"mappings":"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","sourcesContent":["define([\"exports\", \"jquery\", \"core/ajax\", \"core/modal_factory\", \"core/modal_events\", \"core/notification\", \"core/modal\",\n        \"core/custom_interaction_events\", \"core/modal_registry\", \"mod_lanebs/modal_book\", \"mod_lanebs/modal_book_handle\"],\n    function (exports, $, ajax, ModalFactory, ModalEvents, Notification, Modal,\n              CustomEvents, ModalRegistry, ModalBook, ModalBookHandler) {\n\n    $.fn.serializeAssoc = function() {\n            var data = {};\n            $.each( this.serializeArray(), function( key, obj ) {\n                var a = obj.name.match(/(.*?)\\[(.*?)\\]/);\n                if(a !== null)\n                {\n                    var subName = a[1];\n                    var subKey = a[2];\n\n                    if( !data[subName] ) {\n                        data[subName] = [ ];\n                    }\n\n                    if (!subKey.length) {\n                        subKey = data[subName].length;\n                    }\n\n                    if( data[subName][subKey] ) {\n                        if( $.isArray( data[subName][subKey] ) ) {\n                            data[subName][subKey].push( obj.value );\n                        } else {\n                            data[subName][subKey] = [ ];\n                            data[subName][subKey].push( obj.value );\n                        }\n                    } else {\n                        data[subName][subKey] = obj.value;\n                    }\n                } else {\n                    if( data[obj.name] ) {\n                        if( $.isArray( data[obj.name] ) ) {\n                            data[obj.name].push( obj.value );\n                        } else {\n                            data[obj.name] = [ ];\n                            data[obj.name].push( obj.value );\n                        }\n                    } else {\n                        data[obj.name] = obj.value;\n                    }\n                }\n            });\n            return data;\n        };\n\n    let SELECTORS = {\n        SEARCH_TEXTBOX: \"[data-action='search_text']\",\n        START_SEARCH: \"[data-action='search_button']\",\n        START_SEARCH_CLEAR: \"[name='clear_search']\",\n        CANCEL_BUTTON: \"[data-action='cancel_button']\",\n        CONTENT_BLOCK: \"[data-action='content_block']\",\n        BREADCRUMBS: \".breadcrumbs p\",\n        CONTENT_NAME: \"[name='content_name']\",\n        TRIGGER_BOOK: \".trigger_book\",\n        ADD_BOOK: \"[name='add_book']\",\n        CATEGORY_BUTTON: \"[data-action='category_tree']\",\n        CATEGORY_BLOCK: \"[data-action='categories']\",\n        BOOK_PAGINATION: \"#books_pagination li.page-item\",\n        START_PAGE_CLASS: \"page-start\",\n        END_PAGE_CLASS: \"page-end\",\n        PROGRESS: \".loader\",\n    };\n    let LIMIT_ON_PAGE = 10;\n\n    /**\n     * Constructor for the Modal\n     *\n     */\n    let ModalSearch = function(root) {\n        Modal.call(this, root);\n\n        if (!this.getBody().find(SELECTORS.SEARCH_TEXTBOX).length) {\n            Notification.exception({message: 'text box not found'});\n        }\n        if (!this.getBody().find(SELECTORS.START_SEARCH).length) {\n            Notification.exception({message: 'search button not found'});\n        }\n    };\n\n    ModalSearch.TYPE = 'mod_lanebs-search';\n    ModalSearch.prototype = Object.create(Modal.prototype);\n    ModalSearch.prototype.constructor = ModalSearch;\n    ModalSearch.prototype.breadcrumbs = {};\n\n    ModalSearch.prototype.registerEventListeners = function () {\n        Modal.prototype.registerEventListeners.call(this);\n        let disabledEnterSubmit = function (e) {\n            if (e.keyCode === 13) {\n                submitFunction(e);\n                return false;\n            }\n        };\n        let disabledKeyUp = function (e) {\n            if (e.keyCode !== false) {\n                e.preventDefault();\n                return false;\n            }\n        };\n        let submitFunction = function (e) {\n            e.preventDefault();\n            e.stopPropagation();\n            let id = $(SELECTORS.CATEGORY_BLOCK).attr('data-id');\n            let args = {\n                searchParam: $(e.target.form).serializeAssoc(),\n                page: 1,\n                limit: LIMIT_ON_PAGE,\n                catId: id\n            };\n            $(SELECTORS.PROGRESS).toggleClass('hide');\n            ModalSearch.prototype.getAjaxCall('mod_lanebs_search_books', args, ModalSearch.prototype.getSearchResult)\n                .then(function () {\n                    ModalSearch.prototype.resetPagination();\n                    $(SELECTORS.PROGRESS).toggleClass('hide');\n                });\n        };\n\n        let getCategoryTree = function (e) {\n            e.preventDefault();\n            e.stopPropagation();\n            let categoryId = [null];\n            let args = {\n                categoryId: categoryId\n            };\n            ModalSearch.prototype.getAjaxCall('mod_lanebs_category_tree', args, ModalSearch.prototype.printCategories);\n        };\n\n        let setPagination = function (e) {\n            if ($(e.currentTarget).hasClass('disabled')) {\n                return true;\n            }\n            let page, maxPage;\n            if ($(SELECTORS.CONTENT_BLOCK).attr('data-page') === undefined) {\n                maxPage = 0;\n            }\n            else {\n                maxPage = parseInt($(SELECTORS.CONTENT_BLOCK).attr('data-page'));\n            }\n            if ($(e.currentTarget).hasClass(SELECTORS.START_PAGE_CLASS)) {\n                if (maxPage > 0) {\n                    page = 1;\n                }\n                else {\n                    page = 0;\n                }\n            }\n            else if ($(e.currentTarget).hasClass(SELECTORS.END_PAGE_CLASS)) {\n                page = maxPage;\n            }\n            else {\n                page = parseInt($(e.currentTarget).attr('data-page'));\n            }\n            let id = $(SELECTORS.CATEGORY_BLOCK).attr('data-id');\n            let args = {\n                searchParam: {'searchString': $(SELECTORS.SEARCH_TEXTBOX).val()},\n                page: page,\n                limit: LIMIT_ON_PAGE,\n                catId: id\n            };\n            let prevPage = $(SELECTORS.BOOK_PAGINATION).find('a.prev').closest('li.page-item');\n            let nextPage = $(SELECTORS.BOOK_PAGINATION).find('a.next').closest('li.page-item');\n            let currentPage = $(SELECTORS.BOOK_PAGINATION).find('a.active').closest('li.page-item');\n            if (page >= 2) {\n                $(prevPage).attr('data-page', page - 1);\n                $(prevPage).removeClass('disabled');\n            }\n            else if (page === 1) {\n                $(prevPage).attr('data-page', page - 1);\n                $(prevPage).addClass('disabled');\n            }\n            if (maxPage === page) {\n                $(nextPage).addClass('disabled');\n            }\n            else {\n                $(nextPage).removeClass('disabled');\n            }\n            $(nextPage).attr('data-page', page+1);\n            $(currentPage).attr('data-page', page);\n            $(currentPage).find('a.active').text(page+' из '+maxPage);\n            if (page !== 0 && maxPage !== 0) {\n                ModalSearch.prototype.getAjaxCall('mod_lanebs_search_books', args, ModalSearch.prototype.getSearchResult);\n            }\n        };\n\n        this.getModal().on(CustomEvents.events.activate, SELECTORS.START_SEARCH, submitFunction.bind(this));\n        this.getModal().on('click', SELECTORS.START_SEARCH_CLEAR, function (e) {\n            e.preventDefault();\n            e.stopPropagation();\n            $(SELECTORS.SEARCH_TEXTBOX).val('');\n            $(SELECTORS.START_SEARCH).trigger('click');\n            return false;\n        });\n        this.getModal().on('keypress', SELECTORS.SEARCH_TEXTBOX, disabledEnterSubmit.bind(this));\n        this.getModal().on(CustomEvents.events.activate, SELECTORS.BOOK_PAGINATION, setPagination.bind(this));\n        this.getModal().on('keydown', SELECTORS.CONTENT_NAME, disabledKeyUp.bind(this));\n\n        this.getModal().on(CustomEvents.events.activate, SELECTORS.CANCEL_BUTTON, function () {\n            $(this).trigger('hide');\n        }.bind(this));\n\n        this.getModal().on(CustomEvents.events.activate, SELECTORS.CATEGORY_BUTTON, getCategoryTree.bind(this));\n    };\n\n    ModalSearch.prototype.getSearchResult = function (response) {\n        $(SELECTORS.CONTENT_BLOCK).empty();\n        let maxPage = Math.ceil(response.body.total / LIMIT_ON_PAGE);\n        if (response.body.items.length) {\n            $.each(response.body.items, function(number, item) {\n                let descriptionBlock =\n                    '<a class=\"\" data-toggle=\"collapse\" href=\"#collapseDescription'+item.id+'\" role=\"button\">' +\n                        'Посмотреть описание' +\n                    '</a>' +\n                    '<div class=\"collapse\" id=\"collapseDescription'+item.id+'\">' + item.description + '</div>';\n                let authorBlock = '<span class=\"book_author\">'+ item.author +'</span><br>';\n                if (item.description === null || item.description === '') {\n                    item.description = '';\n                    descriptionBlock = '';\n                }\n                if (item.author === null || item.author === '') {\n                    item.author = '';\n                    authorBlock = '';\n                }\n                $(SELECTORS.CONTENT_BLOCK).append(\n                    '<div class=\"item d-flex\" data-id=\"' + item.id + '\">' +\n                        '<div class=\"icon\" style=\"flex:0.03;\">' +\n                            '<mat-icon class=\"mat-icon material-icons\" style=\"color:#4285f4;\" role=\"img\">book</mat-icon>'+\n                        '</div>' +\n                        '<div class=\"item_content\" style=\"flex:0.75;\">' +\n                            authorBlock +\n                            '<span class=\"book_title\">' + item.title + '</span><br>' +\n                            descriptionBlock +\n                        '</div>' +\n                        '<div style=\"flex:0.23;\">' +\n                            '<button type=\"button\" name=\"add_book\" class=\"btn btn-sm ml-3\" style=\"color: #174c8d;' +\n                                    'background-color: white;border-color: #4285f4;\">Добавить</button>' +\n                            '<button type=\"button\" class=\"trigger_book btn btn-sm ml-3 float-right\" style=\"color: #174c8d;' +\n                                    'background-color: white;border-color: #4285f4;\">Предпросмотр</button>'+\n                            '<br>' +\n                            '<span class=\"book_year float-right\" style=\"margin-top:10px;\">'+ item.year +'</span><br>' +\n                        '</div>' +\n                    '</div><hr style=\"margin-top:5px;\">');\n            });\n        }\n        else {\n            $(SELECTORS.CONTENT_BLOCK).append('<div class=\"item\">Книги не найдены</div>');\n        }\n        $(SELECTORS.CONTENT_BLOCK).attr('data-page', maxPage);\n        $(SELECTORS.TRIGGER_BOOK).on('click', function (e) {\n            //if ($(ModalBook.CONTENT_BLOCK).length) {}\n            let title = 'Предпросмотр';\n            ModalBookHandler.init(e, title);\n        });\n        $(SELECTORS.ADD_BOOK).on('click', function (e) {\n            let id = $(e.target).closest('.item').attr('data-id');\n            let contentName = $('[name=\"content_name\"]');\n            //$('[name=\"content_name\"]').text($(e.currentTarget).siblings('.book_title').text());\n            contentName.val($(e.target).closest('.item').find('.item_content .book_title').text());\n            contentName.removeClass('is-invalid');\n            contentName.siblings('#id_error_content_name').text('');\n            $('[name=\"content\"]').val(id);\n            $(SELECTORS.CANCEL_BUTTON).trigger('click');\n        });\n    };\n\n    ModalSearch.prototype.printCategories = function (response) {\n        $(SELECTORS.CATEGORY_BLOCK).empty();\n        $.each(response.body.items, function (number, item) {\n            if (item.available === false) {\n                return false;\n            }\n            $(SELECTORS.CATEGORY_BLOCK).append(\n                '<div style=\"cursor:pointer;color:#174c8d;background-color:white;\" ' +\n                     'class=\"item btn-sm\" data-id=\"'+item.id+'\" data-expand=\"'+item.hasChild+'\" ' +\n                     'data-parent=\"'+item.parent_id+'\">' +\n                    '<span>'+item.name+'</span>' +\n                '</div>');\n\n            $(SELECTORS.CATEGORY_BLOCK).find('[data-id=\"'+item.id+'\"]').click({item: item}, function (e) {\n                e.stopPropagation();\n                e.preventDefault();\n                let id = $(e.currentTarget).attr('data-id');\n                $(SELECTORS.CATEGORY_BLOCK).attr('data-id', id);\n                ModalSearch.prototype.clearCurrentCrumb(response.body.items);\n                ModalSearch.prototype.breadcrumbs[$(this).find('span').text()] = item;\n                if (item.hasChild) {\n                    let args = {\n                        categoryId: [id]\n                    };\n                    ModalSearch.prototype.getAjaxCall('mod_lanebs_category_tree', args, ModalSearch.prototype.printCategories);\n                }\n                else {\n                    if ($(this).hasClass('bg-primary')) {\n                        $(this).removeClass('bg-primary');\n                        let parentId = $(SELECTORS.CATEGORY_BLOCK).find('.item:last').attr('data-parent');\n                        $(SELECTORS.CATEGORY_BLOCK).attr('data-id', parentId);\n                        id = parentId;\n                        ModalSearch.prototype.clearCurrentCrumb(response.body.items);\n                    }\n                    else {\n                        $(this).addClass('bg-primary');\n                        $(this).siblings().removeClass('bg-primary');\n                        $(SELECTORS.CATEGORY_BLOCK).attr('data-id', id);\n                    }\n                    /*let args = {\n                        searchParam: {'searchString': $(SELECTORS.SEARCH_TEXTBOX).val()},\n                        page: 1,\n                        limit: LIMIT_ON_PAGE,\n                        catId: id\n                    };\n                    ModalSearch.prototype.getAjaxCall('mod_lanebs_search_books', args, ModalSearch.prototype.getSearchResult)\n                        .then(function () {ModalSearch.prototype.resetPagination();});*/\n                }\n                ModalSearch.prototype.printBreadcrumbs();\n                $(SELECTORS.START_SEARCH).trigger('click');\n            });\n        });\n\n        let parent_id = $(SELECTORS.CATEGORY_BLOCK).find('.item:last').attr('data-parent');\n        $(SELECTORS.CATEGORY_BLOCK).prepend(\n            '<div style=\"cursor:pointer;margin-bottom:15px;color:#174c8d;background-color:white;\" ' +\n                  'class=\"btn-sm category_back\" data-id=\"'+parent_id+'\">' +\n                '<span>НАЗАД</span>' +\n            '</div>');\n        $(SELECTORS.CATEGORY_BLOCK).find('.category_back').on('click', function () {\n            let parent_id = $(this).attr('data-id');\n            let id = ModalSearch.prototype.searchParentId(parent_id);\n            if (id === null) {\n                id = 'null';\n            }\n            $(SELECTORS.CATEGORY_BLOCK).attr('data-id', id);\n            let args = {\n                categoryId: [id]\n            };\n            if ($(SELECTORS.CATEGORY_BLOCK).find('.item.bg-primary').length > 0) {\n                ModalSearch.prototype.clearCrumbs(2);\n            }\n            else {\n                ModalSearch.prototype.clearCrumbs(1);\n            }\n            ModalSearch.prototype.printBreadcrumbs();\n            ModalSearch.prototype.getAjaxCall('mod_lanebs_category_tree', args, ModalSearch.prototype.printCategories);\n        });\n\n    };\n\n    ModalSearch.prototype.printBreadcrumbs = function () {\n        let crumbs = ModalSearch.prototype.breadcrumbs;\n        let html = '';\n        $(SELECTORS.BREADCRUMBS).empty();\n        $.each(crumbs, function (item, number) {\n            html += '<span class=\"item\" data-id=\"'+number.id+'\">'+item+'</span> -> ';\n        });\n        html = html.slice(0, -3);\n        $(SELECTORS.BREADCRUMBS).append(html);\n    };\n\n    ModalSearch.prototype.getAjaxCall = function (methodname, args, callback) {\n        return ajax.call([\n            {\n                methodname: methodname,\n                args,\n            }\n        ])[0].then(function(response) {\n            return response;\n        }).done(function(response) {\n            callback(JSON.parse(response['body']));\n            return true;\n        }).fail(function (response) {\n            alert(response);\n            return false;\n        });\n    };\n\n    ModalSearch.prototype.resetPagination = function () {\n        let maxPage = parseInt($(SELECTORS.CONTENT_BLOCK).attr('data-page'));\n        $(SELECTORS.BOOK_PAGINATION).find('a.prev').closest('li.page-item').addClass('disabled');\n        $(SELECTORS.BOOK_PAGINATION).find('a.prev').closest('li.page-item').attr('data-page', 0);\n        $(SELECTORS.BOOK_PAGINATION).find('a.active').closest('li.page-item').attr('data-page', 1);\n        $(SELECTORS.BOOK_PAGINATION).find('a.next').closest('li.page-item').attr('data-page', 2);\n        if (maxPage > 1) {\n            $(SELECTORS.BOOK_PAGINATION).find('a.active').text(1+' из '+maxPage);\n            $(SELECTORS.BOOK_PAGINATION).find('a.next').closest('li.page-item').removeClass('disabled');\n        }\n        else {\n            $(SELECTORS.BOOK_PAGINATION).find('a.active').text(maxPage+' из '+maxPage);\n            $(SELECTORS.BOOK_PAGINATION).find('a.next').closest('li.page-item').addClass('disabled');\n        }\n    };\n\n    ModalSearch.prototype.clearCurrentCrumb = function (data) {\n        let tmp = ModalSearch.prototype.breadcrumbs;\n        let lastCrumb = tmp[Object.keys(tmp)[Object.keys(tmp).length - 1]];\n        $.each(data, function (number, item) {\n            if (undefined !== lastCrumb) {\n                if (item.id === lastCrumb.id) {\n                    delete ModalSearch.prototype.breadcrumbs[item.name];\n                }\n            }\n        });\n    };\n\n    ModalSearch.prototype.clearCrumbs = function (count) {\n        let keys = null;\n        let last = null;\n        for (let i = 0; i < count; i++) {\n            keys = Object.keys(ModalSearch.prototype.breadcrumbs);\n            last = keys[keys.length-1];\n            delete ModalSearch.prototype.breadcrumbs[last];\n        }\n    };\n\n    ModalSearch.prototype.searchParentId = function (id) {\n        let parentId = null;\n        $.each(ModalSearch.prototype.breadcrumbs, function (number, item) {\n            if (item.id == id) {\n                parentId = item.parent_id;\n            }\n        });\n        return parentId;\n    };\n\n    ModalRegistry.register(ModalSearch.TYPE, ModalSearch, 'mod_lanebs/modal_search');\n\n    return ModalSearch;\n});"],"file":"modal_search.min.js"}